import matplotlib as plt
import numpy as np
from sklearn import datasets,linear_model
from sklearn.metrics import mean_squared_error

diabetes= datasets.load_diabetes()
diabetes_x = diabetes.data

diabetes_x_train = diabetes_x[:-80]
diabetes_x_test = diabetes_x[:-20]

diabetes_y_train = diabetes.target[:-80]
diabetes_y_test = diabetes.target[:-20]

model=linear_model.LinearRegression()

model.fit(diabetes_x_train,diabetes_y_train)
diabetes_y_predict = model.predict(diabetes_x_test)

print("Mean Squared Error is :", mean_squared_error(diabetes_y_test,diabetes_y_predict))
print("weights:",model.coef_)
print("intercept:",model.intercept_)

output

Mean Squared Error is : 2907.118209034246
weights: [   3.92718202 -253.94486874  520.35846552  300.42819747 -603.58774264
  325.27121483   10.78855295  139.51168049  669.05351038  111.45789687]
intercept: 152.73013266423447
